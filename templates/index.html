<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DermaScan AI Detection</title>
    <style>
        body { font-family: sans-serif; margin: 0; padding: 20px; background-color: #f8fcfc; color: #333; }
        .container { max-width: 900px; margin: auto; padding: 30px; background-color: white; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        .header { text-align: center; margin-bottom: 40px; }
        .header h1 { color: #1e88e5; font-size: 2.5em; margin: 0; }
        .btn-primary { background-color: #1e88e5; color: white; padding: 12px 25px; border: none; border-radius: 8px; cursor: pointer; font-size: 1.1em; transition: background-color 0.3s; }
        .btn-primary:hover { background-color: #1565c0; }
        .input-group { text-align: center; margin-bottom: 40px; }
        .detectable-conditions { text-align: center; margin-top: 40px; padding: 20px; border-top: 1px solid #eee; }
        .condition-tag { display: inline-block; background-color: #e3f2fd; color: #1e88e5; padding: 8px 15px; margin: 5px; border-radius: 20px; font-size: 0.9em; }
        #results-container { margin-top: 30px; border: 1px solid #ddd; padding: 20px; border-radius: 8px; }
        .result-item { padding: 10px 0; border-bottom: 1px dashed #eee; display: flex; justify-content: space-between; }
        .result-item:last-child { border-bottom: none; }
        .confidence-score { font-weight: bold; color: #4caf50; }
        .loading { display: none; text-align: center; color: #1e88e5; margin-top: 20px; }
    </style>
</head>
<body>
    <div class="top-nav">
        <a href="/" class="nav-icon" title="Home">&#x2302;</a> <a href="/logout" class="nav-icon logout-btn" title="Logout">&#x21AA; Logout</a> </div>

    <div class="container">
        <div class="header">
            <h1 style="color: #4CAF50;">DermaScan</h1>
            <h1>AI Skin Disease Detection Platform</h1>
            <p>Upload a skin image and get instant AI-powered analysis with confidence scores and detailed information about detected conditions.</p>
        </div>

        <div class="input-group">
            <input type="file" id="image-upload" accept="image/*" style="display: none;">
            <button class="btn-primary" onclick="document.getElementById('image-upload').click();">
                &#x2191; Start Analysis
            </button>
            <button class="btn-primary" style="background-color: #6c757d;">
                View History
            </button>
            <p id="file-name-display" style="margin-top: 10px; color: #555;">No file selected.</p>
        </div>

        <div id="loading" class="loading">
            <p>Analyzing image... Please wait.</p>
        </div>

        <div id="results-container" style="display:none;">
            <h3>AI Analysis Results</h3>
            <div id="analysis-list">
                </div>
            <p style="margin-top: 15px; font-size: 0.9em; color: #777;">*Note: This is an AI prediction and should not replace professional medical advice.</p>
        </div>
        
        <div class="detectable-conditions">
            <h3>Detectable Conditions</h3>
            <div id="conditions-list">
                {% for condition in conditions %}
                <span class="condition-tag">{{ condition }}</span>
                {% endfor %}
            </div>
        </div>
    </div>

    <script>
        document.getElementById('image-upload').addEventListener('change', function(event) {
            const file = event.target.files[0];
            const fileNameDisplay = document.getElementById('file-name-display');
            const resultsContainer = document.getElementById('results-container');
            const analysisList = document.getElementById('analysis-list');
            const loading = document.getElementById('loading');
            
            if (file) {
                fileNameDisplay.textContent = `Selected File: ${file.name}`;
                resultsContainer.style.display = 'none'; // Hide previous results
                loading.style.display = 'block'; // Show loading indicator
                
                // 1. Create a FormData object to send the file
                const formData = new FormData();
                formData.append('skin_image', file);
                
                // 2. Send the file to the Flask backend
                fetch('/analyze', {
                    method: 'POST',
                    body: formData
                })
                .then(response => response.json())
                .then(data => {
                    loading.style.display = 'none'; // Hide loading
                    
                    if (data.error) {
                        analysisList.innerHTML = `<p style="color: red;">Error: ${data.error}</p>`;
                    } else if (data.analysis) {
                        // 3. Display successful results
                        analysisList.innerHTML = ''; // Clear previous
                        data.analysis.forEach(item => {
                            const resultDiv = document.createElement('div');
                            resultDiv.className = 'result-item';
                            resultDiv.innerHTML = `
                                <span>${item.condition}</span>
                                <span class="confidence-score">${item.confidence}</span>
                            `;
                            analysisList.appendChild(resultDiv);
                        });
                        resultsContainer.style.display = 'block';
                    }
                })
                .catch(error => {
                    loading.style.display = 'none'; // Hide loading on error
                    analysisList.innerHTML = `<p style="color: red;">Network Error: Could not connect to the server.</p>`;
                    resultsContainer.style.display = 'block';
                    console.error('Fetch error:', error);
                });

            } else {
                fileNameDisplay.textContent = 'No file selected.';
            }
        });
    </script>
</body>
</html>
<style>
    /* ------------------------------------------------------------------- */
/* ‚≠êÔ∏è NEW STYLES FOR TOP NAVIGATION ‚≠êÔ∏è */
/* ------------------------------------------------------------------- */
.top-nav {
    position: absolute; /* Allows positioning relative to the viewport/body */
    top: 20px;          /* 20px from the top edge */
    right: 20px;        /* 20px from the right edge */
    z-index: 100;       /* Ensures it's on top of other elements */
    font-size: 1em;
}

.nav-icon {
    color: #333; /* Darker color for visibility */
    text-decoration: none;
    margin-left: 15px;
    padding: 5px 10px;
    border-radius: 4px;
    transition: color 0.2s;
}

.nav-icon:hover {
    color: #1e88e5; /* Highlight on hover */
}

.logout-btn {
    color: #dc3545; /* Standard red for logout/danger */
    font-weight: bold;
}

.logout-btn:hover {
    color: #c82333;
}

/* ------------------------------------------------------------------- */
/* ENSURE BODY IS THE REFERENCE FOR ABSOLUTE POSITIONING */
/* ------------------------------------------------------------------- */
/* This ensures the top/right positioning works correctly */
body {
    /* ... existing styles ... */
    position: relative; /* Add this if 'position: absolute' on .top-nav doesn't work */
    /* ... existing styles ... */
}
    /* ------------------------------------------------------------------- */
    /* üõ†Ô∏è CHANGES FOR FULL PAGE APPEARANCE */
    /* ------------------------------------------------------------------- */
    html, body { 
        height: 100%;
        margin: 0;
        padding: 0;
    }
    
    body { 
        font-family: sans-serif; 
        background-color: #f0f2f5; /* Light gray background for contrast */
        color: #333; 
        
        /* ‚≠êÔ∏è Flexbox centering for full page appearance */
        display: flex;
        justify-content: center; /* Center horizontally */
        align-items: center;    /* Center vertically */
        min-height: 100vh;      /* Ensure it takes full viewport height */
        padding: 20px;
        box-sizing: border-box; /* Include padding in height calculation */
    }

    /* ------------------------------------------------------------------- */
    /* CONTENT CONTAINER STYLE */
    /* ------------------------------------------------------------------- */
    .container { 
        max-width: 750px; /* Reduced width slightly from previous 900px for better center focus */
        width: 100%;
        margin: 20px; 
        padding: 30px; 
        height: 90vh;
        /* Flex properties to stack and justify content vertically */
        display: flex;             
        flex-direction: column;    
        justify-content: space-between; /* Distribute space between header, input, and conditions */
        background-color: white; 
        border-radius: 16px; /* Slightly more rounded corners */
        box-shadow: 0 8px 30px rgba(0,0,0,0.12); /* Softer, more pronounced shadow */
        text-align: center; /* Center content inside the container */
    }
    /* ------------------------------------------------------------------- */
    /* EXISTING STYLES (Kept for functionality) */
    /* ------------------------------------------------------------------- */
    .header { 
        margin-bottom: 30px; 
    }
    .header h1 { 
        color: #4CAF50; /* Green color for DermaScan logo */
        font-size: 2.5em; 
        margin: 0 0 5px 0; 
    }
    .header h1:nth-child(2) {
        color: #1e88e5; /* Blue color for Platform title */
        font-size: 2em;
        margin-bottom: 10px;
    }
    .header p {
        color: #666;
        font-size: 1.1em;
    }

    .btn-primary { 
        background-color: #1e88e5; 
        color: white; 
        padding: 10px 20px; 
        border: none; 
        border-radius: 8px; 
        cursor: pointer; 
        font-size: 1em; 
        transition: background-color 0.3s;
        margin: 5px; 
    }
    .btn-primary:hover { 
        background-color: #1565c0; 
    }
    .input-group { 
        margin-bottom: 25px; 
    }
    .detectable-conditions { 
        margin-top:20px; 
        padding: 20px 0; 
        border-top: 1px solid #eee; 
    }
    .condition-tag { 
        display: inline-block; 
        background-color: #e3f2fd; 
        color: #1e88e5; 
        padding: 6px 12px; 
        margin: 10px; 
        border-radius: 20px; 
        font-size: 0.9em; 
    }
    #results-container { 
        margin-top: 30px; 
        border: 1px solid #ddd; 
        padding: 20px; 
        border-radius: 8px; 
        text-align: left;
    }
    .result-item { 
        padding: 10px 0; 
        border-bottom: 1px dashed #eee; 
        display: flex; 
        justify-content: space-between; 
    }
    .result-item:last-child { 
        border-bottom: none; 
    }
    .confidence-score { 
        font-weight: bold; 
        color: #4caf50; 
    }
    .loading { 
        display: none; 
        text-align: center; 
        color: #1e88e5; 
        margin-top: 20px; 
    }
</style>